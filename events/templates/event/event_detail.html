{% extends 'base.html' %}

{% load static %}

{% block title %}
	<title>{{ event.name }} ansehen</title>
{% endblock title %}

{% block content %}
<script type="text/javascript">
	function myFunction() {
		/* Get the text field */
		var copyText = document.getElementById("link");

		/* Select the text field */
		copyText.select();
		copyText.setSelectionRange(0, 99999); /*For mobile devices*/

		/* Copy the text inside the text field */
		document.execCommand("copy");

		/* Alert the copied text */
		// alert("Copied the text: " + copyText.value);
	}

	function calcSum() {
		var amounts = document.getElementsByClassName('amount-field');
		var prices = document.getElementsByClassName('price');
		var sum = 0.00;
		for (var i = 0; i < amounts.length; i++) {
			var price = parseFloat(prices[i].innerHTML.replace(',', "."));
			var amount = parseInt(amounts[i].value);
			if(Number.isNaN(amount)) {
				amount = 0;
			}
			console.log(i);
			console.log(amount + ' mal ' + price);
			sum += amount * price;
		}
		console.log(sum.toFixed(2));
		document.getElementById('sum').innerHTML = sum.toFixed(2).replace('.', ",");
	}
</script>
<div class="section-18">
    <div class="w-container">
      <div class="intro-text">
        <div class="heading-jumbo">{{ event.name }}</div>
        <div class="divider"></div>
		<p class="paragraph-bigger cc-bigger-white-light">Ein Event von {{ event.creator }} hätte am {{ event.date }} stattgefunden.</p>
		<div class="w-row">
			<div class="w-col w-col-4"></div>
			<div class="w-col w-col-4"><a href="#Tickets" class="button-6 w-button">Zu den Tickets</a></div>
			<div class="w-col w-col-4"></div>
		</div>
	  </div>
	  <p class="paragraph-2">{{ event.description }}<br></p>
	  <h6 class="heading-20">Link zum Teilen dieser Veranstaltung:</h6>
		  <div class="w-form">
			<div class="w-layout-grid grid-4">
				<div></div>
				<input type="text" class="text-field-2 w-input" maxlength="256" name="field" data-name="Field" readonly id="link" value="http://soli-ticket.de{{event.get_absolute_url}}">
				<img src="{% static 'images/icons8-copy-24.png' %}" alt="" onclick="myFunction();" id="copyToClip">
			</div>
		  </div>
      <div class="divider"></div>
      <div class="columns-3 w-row">
        <div class="w-col w-col-4"><img src="{% static 'images/sentiment_satisfied_alt-black-48dp.svg' %}" alt="" class="image-4">
          <p class="paragraph">Solidarität macht nicht arm! Helfen Sie mit dem Geld, das Sie sowieso ausgegeben hätten, den Fortbestand unserer Kulturlandschaft zu sichern.</p>
        </div>
        <div class="column-4 w-col w-col-4"><img src="{% static 'images/money_off-black-48dp.svg' %}" alt="" class="image-4">
          <p class="paragraph">Zahlungen gehen direkt an {{ event.creator.orgaisation_name }}. Soli-Ticket behält keine Gebühr ein. Es fällt lediglich die Gebühr des Zahlungsanbieters an.</p>
        </div>
        <div class="w-col w-col-4"><img src="{% static 'images/share-black-48dp.svg' %}" alt="" class="image-4">
          <p class="paragraph">Solidarität ist ansteckend! <br>Jede Verlinkung oder Empfehlung hilft {{ event.creator }} und Soli-Ticket dabei, die Folgen der Krise zu mildern.</p>
        </div>
      </div>
      <div class="divider"></div>
    </div>
  </div>
  <div id="Tickets" class="section-3">
    <div class="w-container">
      <div class="w-form">
        <form id="wf-form-Ticket-Form" name="wf-form-Ticket-Form" data-name="Ticket Form" method="POST"> {% csrf_token %}
          <div class="w-layout-grid grid-3"><label for="name"><strong>TICKETS</strong></label><label>PREIS (€)</label><label>Anzahl</label>
            {{ order_formset.management_form }}
			{% for buyable, order_form in formset %}
				{% if organiser.organisation_type == 'gemeinnützig' %}
					<p>Spende "{{ buyable.buyable_name }}"</p>
				{% else %}
					<p>{{ buyable.buyable_name }}</p>
				{% endif %}
				<p class="price">{{ buyable.price }}</p>
				{{ order_form.amount }}
			{% endfor %}
			<p class="paragraph-4">Gesamt:</p>
			<p class="paragraph-3" id="sum">0,00</p>
		  </div>
		  <p class="paragraph-5"></p>
		  <p class="paragraph-5">Hinweis: Aus rechtlichen Gründen sind nur Bestellungen bis zu einem Gesamtbetrag von 250€ gestattet.</p>
          <div class="divider"></div>
           <div class="w-row">
            <div class="w-col w-col-5"><label for="name" class="field-label-6"><strong>Email-Adresse</strong></label>
				<input type="email" class="text-field-2 w-input" maxlength="256" name="field-4" data-name="Field 4" id="field-4" required=""></div>
			<div class="column-5 w-col w-col-7"></div>
		  </div>
		  <p class="paragraph-5">Hinweis: Mit dem Erwerb jeglicher Artikel auf dieser Webseite unterstützen Sie den jeweiligen Veranstalter. Dadurch ergeben sich keine Ansprüche auf den Besuch von Veranstaltungen oder den Erhalt von Waren oder Dienstleistungen.<br>Bitte beachten Sie unsere AGB und die Widerrufsbelehrung:<strong></strong></p>
		  <a href="{% url 'agb' %}" class="link-3">Link zu den AGB</a>
          <input type="submit" value="Zahlungspflichtig bestellen" data-wait="Please wait..." class="submit-button ticketconfirmbutton w-button">
        </form>
        <div class="w-form-done">
          <div>Thank you! Your submission has been received!</div>
        </div>
        <div class="w-form-fail">
          <div>Oops! Something went wrong while submitting the form.</div>
        </div>
      </div>
    </div>
  </div>
  <div class="section-4">
    <div class="container-13 w-container">
      <p class="paragraph-bigger cc-bigger-white-light">Über Soli-Ticket.de</p>
      <p class="paragraph-5">Wir sind ein Team von Studierenden, die soli-ticket.de während der Corona-Krise ohne wirtschaftliche Hintergedanken entwickeln. Aufgrund der dynamischen Entwicklungen arbeiten wir unter Hochdruck daran, neue Funktionalitäten anzubieten. Wir halten alles so einfach wie möglich, um schnell helfen zu können. Bitte haben Sie Verständnis dafür, dass wir aber auch nicht zaubern können :-) Wir aktualisieren unsere Webseite regelmäßig bei Neuerungen! <br><strong>#SolidaritätIstAuchAnsteckend #StayAtHome #FlattenTheCurve </strong></p>
    </div>
  </div>
{% endblock %}
